<?php
  require __DIR__ . '/auth/src/bootstrap.php';
  require_login();
  inactivity_time();


function human_filesize($bytes, $decimals = 2) {
    $factor = floor((strlen($bytes) - 1) / 3);
    if ($factor > 0) $sz = 'KMGT';
    return sprintf("%.{$decimals}f", $bytes / pow(1024, $factor)) . @$sz[$factor - 1] . 'B';
}
function line($Num) {
  $files = [
    ['optimus-5.2.0.19-full-ru.zip','Русский','zip'],
    ['optimus-5.2.0.19-full-en.zip','English','zip'],
    ['optimus-5.2.0.19-core-ru.zip','Русский','zip'],
    ['optimus-5.2.0.19-core-en.zip','English','zip'],
    ['Reports_ru.zip','Русский','zip'],
    ['Reports_ua.zip','Українська','zip'],
    ['Reports_en.zip','English','zip'],
    ['Firebird-5.0.2.1613-0-windows-x86.zip','ZIP','zip'],
    ['Firebird-5.0.2.1613-0-windows-x86.exe','EXE','binary'],
    ['operation_manual_ru.doc','Русский','word'],
    ['operation_manual_ru.pdf','Русский','pdf'],
    ['training_fs_ru.doc','Русский','word'],
    ['training_fs_ua.doc','Українська','word'],
    ['training_gs_ru.doc','Русский','word'],
    ['','',''],
  ];
  $filename = './downloads/'.$files[$Num][0];
  if (file_exists($filename)) {
    echo '<i class="bi bi-file-'.$files[$Num][2].'"></i> '.
       '<a href="'.$filename.'">'.$files[$Num][1].'</a>  <span class="text-secondary text-nowrap m-3"><small>'.
         date ("j-M-Y", filectime($filename)).' - '.human_filesize(filesize($filename),2).'</small></span>';
  } else {
    echo "<i class='text-danger'>file $filename doesn't exists</i>";
  }
}
?>

<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
  <head>
    <title>Official OPTIMUS Results Site</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

    <!-- Add icon library -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
  </head>
  <body lang="en">

<div class="container">
     <!-- page header -->
    <header class="" style="background-image: url(images/Title.jpg); background-size: 100% auto;">
    <!--div style="background: linear-gradient(#b35900 55%, white);"-->
        <div class="row align-items-center">
           <div class="col">
		<a href="about.html"><img src="images/turtleZ_color.png" alt="LOGO" class="float-start m-3" height="100px"></a>
                <div class="m-3"><span class="fs-1 fw-bold">OPTIMUS</span> by  <span class="text-light fw-bold">Zeroturtle</span><br>
                </div>
           </div>
           <div class="col m-3 text-end">
		<?php if(!is_user_logged_in()) { ?>
			<a href="auth/login.php" class="btn btn-outline-dark pull-right text-nowrap" role="button">Sign In</a>
		<?php } else { ?>
	                <a href="auth/logout.php" class="btn btn-outline-dark pull-right text-nowrap" >Logout, <?php echo htmlspecialchars($_SESSION['username'], ENT_QUOTES)?></a>
		<?php } ?>
           </div>
         </div>
    </header>


<!-- отправка новая лицензия -->
<h2 class="display-3">OPTIMUS <span class="text-success">download page</span></h2>
<p><b>Current build 5.2.1.0 </b></p>

<section class="border-bottom pb-5">
    <span class="dl-info">
      <span class="dl-title">Full package:
              <ul>
                <li><?php line(0); ?> </li>
                <li><?php line(1); ?> </li>
              </ul>
    </span>
</section>

<section class="border-bottom pb-5" style="background-color: #f2f2f2;">
    <div class="row">
      <div class="col-sm-6">
        <span class="h3 text-center">Components </span>
        <ul>
          <li>
            <span class="dl-title">OPTIMUS core files <small>(exe & dll, fdb)</small>:  
              <ul>
                <li><?php line(2); ?> </li>
                <li><?php line(3); ?> </li>
              </ul>
            </span>
          </li>
          <li>
            <span class="dl-title">Print report templates:
              <ul>
                <li><?php line(4); ?> </li>
                <li><?php line(5); ?> </li>
                <li><?php line(6); ?> </li>
              </ul>
            </span>
          </li>
          <li>
            <span class="dl-title">Firebird SQL server x86 v5.0.2:<br>  
              <small>(You can download it from the official website <a href="https://www.firebirdsql.org/en/firebird-5-0" class="text-decoration-none"> The Firebird Project</a>)</small> 
              <ul>
                <li><?php line(7); ?> </li>
                <li><?php line(8); ?> </li>
              </ul>
            </span>
          </li>
        </ul>
      </div>
      <div class="col-sm-6">
        <span class="h3 text-center">Documentation</span><br>
        <ul>
          <li>
            <span class="dl-title"> OPTIMUS operational manual:   
              <ul>
                <li><?php line(9); ?> </li>
                <li><?php line(10); ?> </li>
              </ul>
          </li>
          <li><span class="dl-title"> Formation Skydiving guide: 
              <ul>
                <li><?php line(11); ?> </li>
                <li><?php line(12); ?> </li>
              </ul>
            </span>
          </li>
          <li>
            <span class=""> Organizing competition guide:  
              <ul>
                <li><?php line(13); ?> </li>
              </ul>
            </span>
          </li>
        </ul>
      </div>
    </div>
</section>

<!--section class="border-bottom pb-5">
  Explore <a href="whatsnew">what’s great</a> about the latest release the <strong>OPTIMUS Artemis </strong> available since June 2025.
</section-->

<section class="border-bottom pb-5">
   <span class="h3 text-center">Update to the latest build.</span><br>
   <b>ВНИМАНИЕ!</b>  Техподдержка оказывается только для пользователей с активной лицензией. Консультации только по текущей версии системы (той что выложеная на web).
   Лицензия включена в годовую подписку.
   Если вы имеете активную Site-лицензию напишите запрос в <a href="mailto:support@optimus.dp.ua">службу поддержки</a>, где укажите №лицензии и версию системы.
   Для пользоватлей Single-лицензии продление не доступно, потребуется оформление новой подписки.
   <p>Compare your maintenance term to the release date of the latest build.  License terms you can check in About window.</p>

   <p class="text-center"><a href="licence.html" class="btn btn-lg btn-primary rounded-pill">Subscribe</a> </p>
</section>

<section class="border-bottom pb-5">
   See <a href="#" id="history">Version history</a>
   <div id="fileContent"><pre></pre></div>
   <script>
     async function loadFile(filePath) {
       try {
         const response = await fetch(filePath);
         const fileContent = await response.text();
         return fileContent;
       } catch (error) {
         console.error("Ошибка загрузки файла:", error);
         return null;
       }
     }
     const fileInput = document.getElementById('history');
     fileInput.addEventListener('click', (event) => {
       event.preventDefault();
       //const fileContent = loadFile("https://127.0.0.1/whatsnew");
       loadFile("https://zeroturtle.github.io/whatsnew").then(fileContent => {
          if (fileContent) {
            let divElement = document.getElementById("fileContent");
            //divElement.textContent = fileContent;
            //divElement.innerHTML = `<pre>${fileContent}</pre>`;
            divElement.querySelector('.pre').textContent = fileContent;
            //console.log(fileContent);
          }
       })
     });
   </script>
</section>

<section class="border-bottom pb-5">
  <span class="h3 text-center">How you can contribute…</span><br>
  <ul>
    <li>Translate content <br>
	Help us translate Optimus products into your local language.</li>
    <li>Contribute to the Optimus codebase<br>
	Actively improve Optimus by contributing to a variety of development opportunities.</li>
    <li>Join the community<br>
	Want to get more involved in the Optimus community? Check out all the volunteer opportunities in our Community Portal.</li>
  </ul>
       <p>Have a questions?  Please contact us via  <a href="mailto:support@optimus.dp.ua">email</a> or submit your question via <a href="contact.html">Web form</a>.</p>
</section>




  <footer class="d-flex flex-wrap justify-content-between align-items-center py-3 my-4">
    <div class="d-flex p-2 align-items-center flex-fill" style="background-image: radial-gradient(circle at top right,#08088A,#58A2FA 50%);">
      <span class="mb-3 mb-md-0 text-body-secondary"> 
        &copy 2025  <a href="mailto:support@optimus.dp.ua">Optimus Team</a><br>
      </span>
    </div>
  </footer>

</div> <!--container-->

  </body>
</html>