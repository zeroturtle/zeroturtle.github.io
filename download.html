<?php
  require __DIR__ . '/auth/src/bootstrap.php';

  inactivity_time();
  require_login();


function human_filesize($bytes, $decimals = 2) {
    $factor = floor((strlen($bytes) - 1) / 3);
    if ($factor > 0) $sz = 'KMGT';
    return sprintf("%.{$decimals}f", $bytes / pow(1024, $factor)) . @$sz[$factor - 1] . 'B';
}
function line($Num) {
  $files = [
    ['optimus-5.3.0.5-full.zip','Optimus v5.3 "Pegasus" full pack, Русский/English','zip'],
    ['','','x'],
    ['optimus-5.3.0.5-core.zip','Optimus v5.3 "Pegasus" core files, Русский/English','zip'],
    ['','','x'],
    ['Reports_ru.zip','Русский','zip'],
    ['Reports_ua.zip','Українська','zip'],
    ['Reports_en.zip','English','zip'],
    ['Firebird-5.0.2.1613-0-windows-x86.zip','Firebird-5.0.2.1613-0-windows-x86.zip','zip'],
    ['Firebird-5.0.2.1613-0-windows-x86.exe','Firebird-5.0.2.1613-0-windows-x86.exe','binary'],
    ['operation_manual_ru.doc','Руководство пользователя DOC, Русский','word'],
    ['operation_manual_ru.pdf','Руководство пользователя PDF, Русский','pdf'],
    ['training_fs_ru.doc','Методичка FS, Русский','word'],
    ['training_fs_ua.doc','Методичка FS, Українська','word'],
    ['training_gs_ru.doc','Методичка организация соревнований, Русский','word'],
    ['','',''],
  ];
  $filename = './downloads/'.$files[$Num][0];
  if (file_exists($filename)) {
    echo '<i class="bi bi-file-'.$files[$Num][2].'"></i> '.
       '<a href="'.$filename.'">'.$files[$Num][1].'</a>  <span class="text-secondary text-nowrap m-3"><small>'.
         date ("j-M-Y", filectime($filename)).' - '.human_filesize(filesize($filename),2).'</small></span>';
  } else {
    echo "<i class='text-danger'>file $filename doesn't exists</i>";
  }
}
?>

<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
  <head>
    <title>OPTIMUS Client Assistant</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

    <!-- Add icon library -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
  </head>
  <body lang="en">

<div class="container">
     <!-- page header -->
    <header class="" style="background-image: url(images/Title.jpg); background-size: 100% auto;">
    <!--div style="background: linear-gradient(#b35900 55%, white);"-->
        <div class="row align-items-center">
           <div class="col">
		<a href="about.html"><img src="images/turtleZ_color.png" alt="LOGO" class="float-start m-3" height="100px"></a>
                <div class="m-3"><span class="fs-1 fw-bold">OPTIMUS</span>  </div>
           </div>
           <div class="col m-3 text-end">
		<?php if(!is_user_logged_in()) { ?>
			<a href="auth/login.php" class="btn btn-outline-dark pull-right text-nowrap" role="button">Sign In</a>
		<?php } else { ?>
	                <a href="auth/logout.php" class="btn btn-outline-dark pull-right text-nowrap" >Logout, <?php echo htmlspecialchars($_SESSION['username'], ENT_QUOTES)?></a>
		<?php } ?>
           </div>
         </div>
    </header>


<!-- отправка новая лицензия -->
<p class="display-4">OPTIMUS <span class="text-success">Support Center</span></p>
<p>The all-in-one judging software for skydiving competitions — ready to use after quick sign-in and license activation.</p>

<section id="download" class="border-bottom py-3 bg-secondary-subtle">
    <div class="row">
      <div class="col-sm-6">
        <p><strong>Current build 5.3.0.3 </strong></p>
        <span class="h3 text-center">Download Full package: </span>
        <ul>
          <li><?php line(0); ?> <br> <small><a href="#whatsnew">Read release notes</a> </small> </li>
        </ul>
      </div>
    </div>
    <hr>
    <div class="row">
      <div class="col-sm-6">
        <span class="h3 text-center">Download Components: </span>
        <ul>
          <li>
            <span>Core files <small>(exe & dll, fdb)</small>:  
              <ul>
                <li><?php line(2); ?> </li>
              </ul>
            </span>
          </li>
          <li>
            <span>Print templates:
              <ul>
                <li><?php line(4); ?> </li>
                <li><?php line(5); ?> </li>
                <li><?php line(6); ?> </li>
              </ul>
            </span>
          </li>
          <li>
            <span>Firebird SQL server x86 v5.0.2:<br>  
              <small>(You can download it from the official website <a href="https://www.firebirdsql.org/en/firebird-5-0" class="text-decoration-none"> The Firebird Project</a>)</small> 
              <ul>
                <li><?php line(7); ?> </li>
                <li><?php line(8); ?> </li>
              </ul>
            </span>
          </li>
        </ul>
      </div>
      <div class="col-sm-6">
        <span class="h3 text-center">Documentation</span><br>
        <ul>
          <li>
            <span> OPTIMUS operational manual:   
              <ul>
                <li><?php line(9); ?> </li>
                <li><?php line(10); ?> </li>
              </ul>
          </li>
          <li>
            <span> Formation Skydiving guide: 
              <ul>
                <li><?php line(11); ?> </li>
                <li><?php line(12); ?> </li>
              </ul>
            </span>
          </li>
          <li>
            <span> Organizing competition guide:  
              <ul>
                <li><?php line(13); ?> </li>
              </ul>
            </span>
          </li>
        </ul>
      </div>
    </div>
  <hr>
  <p><small>
   Runs on Windows 7 or later.  There are no macOS or Linux version planned. <br>
   No admin rights required.  No installation or external software dependencies. 
   </small></p>
</section>

<!--
<section id="support" class="border-bottom py-3">
  <p class="h3">Support Notes</p>
</section>
-->

<section id="support" class="border-bottom py-3">
  <p class="display-4">Activation Guide</p>
<ul type="none">
  <li><i class="bi bi-1-circle"></i></span>  Download the installer.</li>
  <li><i class="bi bi-2-circle"></i></span>  Sign in with your OPTIMUS account and <a href="licence.html"> Activate your license</a>.</li>
  <li><i class="bi bi-3-circle"></i></span>  Enter your license key into startup parameters and start judging instantly.</li>
</ul>

  <div class="m-3 p-3 text-center bg-primary-subtle">
    <h5>Support & Help</h5>
    If you have any questions or issues, please contact us via  <a href="mailto:support@optimus.dp.ua">email</a> or submit your question via <a href="contact.html">Web form</a>.
    We are always ready to assist you.
  </div>
</section>


<section class="border-bottom py-3 bg-secondary-subtle" >
  <div class="row m-3">
    <div class="d-flex align-items-center">
      <div class="col-sm-8">
        <p class="display-4">How you can <span class="text-danger">contribute…</span></p>
        <p>OPTIMUS keeps growing with help from judges, developers, and competition organizers worldwide.  Your feedback shapes new features and improvements.</p>
        <ul>
          <li>Share Your Experience<br>
            Want to get more involved in the Optimus community? Send your feedback, ideas, and feature requests. Help us make judging more efficient for everyone.</li>
          <li>Collaborate<br>
            Are you a developer or national federation representative?  Partner with us to extend OPTIMUS’ reach.</li>
          <li>Become a Beta Tester<br>
            Get early access to new judging tools and help validate workflows before release. (No coding required)</li>
          <li>Translate content <br>
            Help us translate Optimus products into your local language.</li>
        </ul>
      </div>
      <div class="col-sm-4 text-center">
        <img src="images/OPTIMUS3.svg" style="max-width: 100%;" alt="subscibe">
      </div>
    </div>
  </div>
</section>



<section id="whatsnew" class="border-bottom py-3">
  <p class="display-4"><span class="text-danger">OPTIMUS</span> evolution</p>
  <p>Interested in the full development history?  
  Download the complete changelog covering all updates, fixes, and feature milestones.</p>
   <div id="fileContent" class="mx-3 border bg-info-subtle"><a href="#" id="history">📄 Download Release Notes Archive</a></div>
   <script>
     async function loadFile(filePath) {
       try {
         const response = await fetch(filePath);
         const fileContent = await response.text();
         return fileContent;
       } catch (error) {
         console.error("Ошибка загрузки файла:", error);
         return null;
       }
     }
     const fileInput = document.getElementById('history');
     fileInput.addEventListener('click', (event) => {
       event.preventDefault();
       //const fileContent = loadFile("https://localhost/whatsnew");
       loadFile("https://zeroturtle.github.io/whatsnew").then(fileContent => {
          if (fileContent) {
            let divElement = document.getElementById("fileContent");
            divElement.innerHTML = `<pre>${fileContent}</pre>`;
          }
       })
     });
   </script>
</section>


  <footer class="py-3 my-4" style="background-image: radial-gradient(circle at top right,#08088A,#58A2FA 50%);">
    <div class="row text-white-50">
      <div class="col-sm m-4">
        <div>
          <img src="images/turtleZ_color.png" style="height:2rem; float:left; margin: 5px;">
          <p class=""> &copy  2008-2025 &nbsp;<span class="text-white fw-bold h4" nowrap>  Zeroturtle</span></p>
        </div>
        <div class="align-bottom py-3 h4">
          <ul class="list-inline">
            <li class="list-inline-item"><i class="bi bi-facebook"></i></li>
            <li class="list-inline-item"><i class="bi bi-instagram"></i></li>
            <li class="list-inline-item"><i class="bi bi-twitter-x"></i></li>
            <li class="list-inline-item"><i class="bi bi-telegram"></i></li>
          </ul>
        </div>
      </div>
      <div class="col-sm m-4">
        <h4 class="text-white-50">Quick Links</h4>
        <ul class="list-unstyled">
          <li class="mb-2"><a href="about.html" class="link-light link-offset-2 link-underline link-underline-opacity-0 link-underline-opacity-75-hover">About</a></li>
          <li class="mb-2"><a href="download.html" class="link-light link-offset-2 link-underline link-underline-opacity-0 link-underline-opacity-75-hover">Download</a></li>
          <li class="mb-2"><a href="licence.html" class="link-light link-offset-2 link-underline link-underline-opacity-0 link-underline-opacity-75-hover">Service</a></li>
          <li class="mb-2"><a href="contact.html" class="link-light link-offset-2 link-underline link-underline-opacity-0 link-underline-opacity-75-hover">Contact</a></li>
        </ul>
      </div>
    </div>
  </footer>

</div> <!--container-->

  </body>
</html>